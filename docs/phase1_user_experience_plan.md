# Phase 1 現状把握とユーザー体験改善計画

## 1. 現状診断

### UI / UX
- 左側サイドバーはアイコンのみで構成されており、各ページは中央メインビューで展開される。
- ホーム画面には売上・利益率・手元資金などのメトリックカードとアラートが並び、内部スクロールが発生する。
- タブ切替時に「Home」キー操作が必要になるなど、深いスクロールがユーザー操作の負荷を高めている。

### 機能
- データ入力（3C 分析、ビジネスモデルキャンバス、財務計画）、KPI／損益分岐分析、キャッシュフロー、シナリオ比較、感度・リスク分析、レポート生成、設定が実装済み。
- シナリオ分析では DSCR 下限値や VaR 信頼水準を設定し、ベースライン／ベスト／ワーストシナリオの比較表とチャートを提供。

### レポート出力
- McKinsey 風テンプレートをベースに PDF／PowerPoint／Excel／Word を生成可能。
- 企業ロゴや印影のアップロード、出力セクション選択が可能。

### 設定
- 「単位・期間」「言語」「既定値リセット」「バックアップ・セキュリティ」の 4 タブで構成。
- 年度、FTE、UI 言語などの管理が行える。

## 2. 課題整理

| 課題カテゴリ | 概要 |
| --- | --- |
| ユーザーフレンドリー性 | アイコンのみのサイドバーは初見ユーザーに意味が伝わりにくい。内部スクロールが多層化し、タブ切替が煩雑。 |
| 認知負荷 | 入力項目が多く、どこから着手すべきか迷う。用語説明が画面遷移で参照しづらい。 |
| デザイン性 | 青系グラデーションと白背景の組み合わせはあるものの、高級感やブランド感が弱い。 |
| 実用性 | データ未入力時はサンプル値のみで計算されるため価値が伝わりにくく、指標が空欄になるケースがある。 |
| 操作負荷 | 報告書出力や設定変更の一連のフローが可視化されておらず、ユーザージャーニーが分断されている。 |

## 3. 改善提案（短期実装案）

### 3.1 ナビゲーションとユーザージャーニーの明確化
- サイドバーにアイコンとラベルを併記し、ツールチップとアクティブ状態を明示。
- 主要ページに番号付きステップガイドを表示し、「入力 → 分析 → シナリオ → レポート」までの流れを示す。
- Sticky ヘッダでタブを常時表示し、スクロール中でもページ内タブを切り替えられるようにする。

### 3.2 フォーム入力の分割と進捗表示
- 長いフォームを複数セクションへ分割し、ステッパーまたは進捗バーを実装。
- 3C 分析 → ビジネスモデルキャンバス → 販売計画 → コスト・投資計画の順で「保存／次へ」遷移を提供。
- 各項目に情報アイコンを設置し、ツールチップやヘルプリンク（PEST 分析、バリューチェーンなど）を表示。

### 3.3 UI の高級感向上
- コンポーネントに統一した角丸・余白・陰影を適用し、ネイビーブルー×グレー×アクセントカラーで統一。
- KPI カードにアイコンと主要数値を大きく表示し、前年同月比などのトレンド指標を追加。
- フォントを Inter や Noto Sans などのモダンな選択へ変更し、McKinsey スタイルの洗練さを演出。

### 3.4 データ保存とエラー処理の強化
- `st.session_state` を活用し、入力途中でも値を保持してページ遷移しても失われないようにする。
- 保存失敗時には具体的なエラーメッセージを表示し、再試行手段を明示。
- 未入力時には必須フィールドをハイライトし、サンプル値だけでなく入力支援コメントも表示。

### 3.5 短期フェルミ推定による効果検証
- ナビゲーション改善により目的ページ到達までの平均クリック数が 12 → 5 に減少すると仮定。
- 平均 1 分の操作時間短縮 × 年間利用者 1,000 人 × 4 回 / 年 ≒ 年間 70 時間の節約効果を試算。

## 4. Streamlit 実装ヒント

```python
import streamlit as st

NAV_ITEMS = {
    "Home": "🏠 ホーム",
    "Inputs": "📝 入力",
    "Analysis": "📊 分析",
    "Scenarios": "🔀 シナリオ",
    "Report": "📄 レポート",
    "Settings": "⚙️ 設定",
}
selected_page = st.sidebar.radio("メニュー", list(NAV_ITEMS.values()))

st.markdown(
    """
    <style>
    .sticky-header {position: sticky; top: 0; background-color: white; z-index: 100;}
    </style>
    """,
    unsafe_allow_html=True,
)

with st.container():
    header = st.container()
    header.markdown("<div class='sticky-header'>" "</div>", unsafe_allow_html=True)
    tabs = st.tabs(["KPI分析", "損益分岐点", "キャッシュフロー", "SWOT/PEST"])
```

- `st.progress()` や `st.form_submit_button()` を活用し、セクションごとに保存と進捗を見せる。
- `st.info()` や `st.expander()` で専門用語解説の折りたたみ表示を行い、スクロール中でも参照しやすくする。
- `st.session_state` を使ったデータ保持の例：

```python
if st.button("保存"):
    st.session_state.setdefault("input_data", {})
    st.session_state["input_data"].update(form_data)
    st.success("データを保存しました")
```

## 5. 次のアクション

1. デザイン言語とコンポーネントスタイルの再定義（Figma 等でモック作成）。
2. サイドバーとヘッダの UI 改修を先行実装し、ユーザビリティテストを実施。
3. フォーム分割と進捗管理の実装をページ単位で段階的に適用。
4. セッション保存ロジックとバリデーション、エラー処理を統一的に整備。
5. 施策実装後にクリックトラッキングや操作時間の観測を行い、効果検証を継続。
